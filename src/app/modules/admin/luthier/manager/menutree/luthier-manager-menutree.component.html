<div class="h-full inset-0 flex flex-col min-w-0 overflow-hidden bg-card dark:bg-transparent z-50">
    <mat-drawer-container class="flex-auto h-full">

        <!-- Drawer -->
        <mat-drawer
            class="w-96 dark:bg-gray-900"
            (opened)="openedNav()"
            [autoFocus]="false"
            [mode]="drawerMode"
            [opened]="drawerOpened"
            #matDrawer>
            <div class="py-1 h-full flex flex-col overflow-hidden">
                <!-- Header -->
                <div class="flex flex-col flex-0 p-1 border-b dark:bg-transparent">
                    <mat-tab-group #tabGroup class="h-full overflow-y-auto">
                        <mat-tab [labelClass]="['text-sm', 'font-bold']" aria-label="fields" label="Menus">
                        </mat-tab>
                        <mat-tab [labelClass]="['text-sm', 'font-bold']" label="Subsistemas">
                        </mat-tab>
                    </mat-tab-group>
                </div>
                <div class="flex-auto w-full overflow-y-auto overflow-x-hidden">
                    <div class="flex flex-col flex-auto w-full h-full" [ngClass]="tabGroup.selectedIndex !== 0 ? 'hidden': ''">
                        <div class="flex-none flex justify-between items-center pt-1">
                            <div class="flex-none flex">

                            </div>
                            <div class="flex-none flex md:w-1/2 md:pr-1">
                                <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                                    <mat-icon
                                        class="evolui-menu-item-icon"
                                        fontSet="fas" fontIcon="fa-search"
                                        matPrefix></mat-icon>
                                    <input
                                        [autocomplete]="'off'"
                                        class="text-sm"
                                        (input)="filterMenu($event)"
                                        matInput>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto" cdkScrollable>
                            <table #table mat-table matSort #sortMenu="matSort" [dataSource]="datasourceMenu" class="table-auto" (matSortChange)="announceSortChange($event)">

                                <ng-container matColumnDef="buttons">
                                    <th mat-header-cell *matHeaderCellDef>
                                        <div class="flex flex-row items-center">
                                            <button mat-icon-button aria-label="Add" (click)="addMenu()">
                                                <mat-icon class="icon-size-3 text-blue-500" fontSet="fas" fontIcon="fa-plus"></mat-icon>
                                            </button>
                                            <button mat-icon-button aria-label="Add" (click)="refreshMenu()">
                                                <mat-icon class="icon-size-3 text-blue-500" fontSet="fas" fontIcon="fa-sync"></mat-icon>
                                            </button>
                                        </div>
                                    </th>
                                    <td mat-cell *matCellDef="let model">
                                        <div class="flex flex-row items-center">
                                            <div>
                                                <button mat-icon-button aria-label="Edit" [disabled]="model.code === -1" (click)="editMenu(model.code)" matTooltip="Editar Menu">
                                                    <mat-icon class="icon-size-3 text-blue-500" fontSet="fas" fontIcon="fa-edit"></mat-icon>
                                                </button>
                                            </div>
                                            <button mat-icon-button aria-label="Delete" [disabled]="model.code === -1" (click)="deleteMenu(model.code)" matTooltip="Remover Menu">
                                                <mat-icon class="icon-size-3 text-red-500" fontSet="fas" fontIcon="fa-trash"></mat-icon>
                                            </button>

                                        </div>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="code">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.code }} </td>
                                </ng-container>
                                <ng-container matColumnDef="caption">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Caption </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.caption }} </td>
                                </ng-container>
                                <ng-container matColumnDef="visibility">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Visibilidade </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.visibility }} </td>
                                </ng-container>
                                <ng-container matColumnDef="lockBy.name">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Locked </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.lockBy?.name }} </td>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="displayedMenuColumns; sticky: true"></tr>
                                <tr mat-row *matRowDef="let row; columns: displayedMenuColumns;"></tr>
                            </table>
                        </div>

                    </div>
                    <div class="flex flex-col flex-auto w-full h-full" [ngClass]="tabGroup.selectedIndex !== 1 ? 'hidden': ''">
                        <div class="flex-none flex justify-between items-center pt-1">
                            <div class="flex-none flex">

                            </div>
                            <div class="flex-none flex md:w-1/2 md:pr-1">
                                <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                                    <mat-icon
                                        class="evolui-menu-item-icon"
                                        fontSet="fas" fontIcon="fa-search"
                                        matPrefix></mat-icon>
                                    <input
                                        [autocomplete]="'off'"
                                        class="text-sm"
                                        (input)="filterSubsystem($event)"
                                        matInput>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="flex-1 overflow-y-auto" cdkScrollable>
                            <table #table mat-table matSort #sortSubsystem="matSort" [dataSource]="datasourceSubsystem" class="table-auto" (matSortChange)="announceSortChange($event)">

                                <ng-container matColumnDef="buttons">
                                    <th mat-header-cell *matHeaderCellDef>
                                        <div class="flex flex-row items-center">
                                            <button mat-icon-button aria-label="Add" (click)="addSubsystem()">
                                                <mat-icon class="icon-size-3 text-blue-500" fontSet="fas" fontIcon="fa-plus"></mat-icon>
                                            </button>
                                            <button mat-icon-button aria-label="Add" (click)="refreshSubsystem()">
                                                <mat-icon class="icon-size-3 text-blue-500" fontSet="fas" fontIcon="fa-sync"></mat-icon>
                                            </button>
                                        </div>
                                    </th>
                                    <td mat-cell *matCellDef="let model">
                                        <div class="flex flex-row items-center">
                                            <div>
                                                <button mat-icon-button aria-label="Edit" [disabled]="model.code === -1" (click)="editSubsystem(model.code)" matTooltip="Editar Subsistema">
                                                    <mat-icon class="icon-size-3 text-blue-500" fontSet="fas" fontIcon="fa-edit"></mat-icon>
                                                </button>
                                            </div>
                                            <button mat-icon-button aria-label="Delete" [disabled]="model.code === -1" (click)="deleteSubsystem(model.code)" matTooltip="Remover Subsistema">
                                                <mat-icon class="icon-size-3 text-red-500" fontSet="fas" fontIcon="fa-trash"></mat-icon>
                                            </button>

                                        </div>
                                    </td>
                                </ng-container>
                                <ng-container matColumnDef="code">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Código </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.code }} </td>
                                </ng-container>
                                <ng-container matColumnDef="description">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Descrição </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.description }} </td>
                                </ng-container>
                                <ng-container matColumnDef="status">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Situação </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.status }} </td>
                                </ng-container>
                                <ng-container matColumnDef="plataform">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Plataforma </th>
                                    <td mat-cell *matCellDef="let model"> {{ model.plataform }} </td>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="displayedSubsystemColumns; sticky: true"></tr>
                                <tr class="cursor-pointer" mat-row (click)="onSubsystemRowClicked(row, $event)" *matRowDef="let row; columns: displayedSubsystemColumns;"></tr>
                            </table>
                        </div>

                    </div>
                </div>

            </div>
        </mat-drawer>

        <!-- Drawer content -->
        <mat-drawer-content class="flex flex-col overflow-hidden">
            <div class="relative h-full w-full">
                <div class="absolute top-0 left-0 z-50">

                    <button class="min-h-7 h-7 "
                            mat-icon-button
                            (click)="matDrawer.toggle()">
                        <mat-icon [svgIcon]="'heroicons_outline:bars-3'"></mat-icon>
                    </button>
                </div>

                <mat-tab-group #menuTreeTab class="subsystem-tab mx-10">
                    <ng-container *ngFor="let subsystem of datasourceSubsystem.filteredData;let i = index">
                        <mat-tab [labelClass]="['text-sm', 'font-bold']" label="{{subsystem.description}}">
                        </mat-tab>
                    </ng-container>
                </mat-tab-group>
            </div>

        </mat-drawer-content>

    </mat-drawer-container>


</div>
