<mat-accordion class="h-full flex flex-col headers-align" multi [formGroup]="formSave">
    <div class="flex-none flex mb-2">
        <div [matTooltip]="canSave() === false ? showValidationsError() : ''">
            <button class="text-sm min-h-7 h-7"
                    mat-flat-button
                    [disabled]="canSave() === false"
                    color="primary" (click)="save()">
                <mat-icon
                    class="icon-size-4"
                    svgIcon="mat_solid:save"></mat-icon>
                <span class="ml-2">Salvar</span>
            </button>
        </div>
        <button class="text-sm min-h-7 h-7"
                mat-flat-button
                color="accent" (click)="revert()">
            <mat-icon
                class="icon-size-4"
                svgIcon="mat_solid:undo"></mat-icon>
            <span class="ml-2">Reverter</span>
        </button>
        <button class="text-sm min-h-7 h-7"
                mat-flat-button
                color="warn" [matMenuTriggerFor]="menuImportDataset">
            <mat-icon
                class="icon-size-4"
                svgIcon="mat_solid:import_export"></mat-icon>
            <span class="ml-2">Importar</span>
        </button>
        <mat-menu #menuImportDataset="matMenu">
            <button mat-menu-item (click)="readDatasetFromClipboard()">
                <mat-icon [svgIcon]="'mat_outline:content_copy'"></mat-icon>
                Importar do Clipboard
            </button>
            <button mat-menu-item (click)="fileTableInput.click()">
                <mat-icon [svgIcon]="'mat_solid:file_download'"></mat-icon>
                Importar de Arquivo
            </button>
            <input type="file" #fileTableInput (change)="readDatasetFromFile($event)" accept=".json" style="display: none;" />
        </mat-menu>
    </div>
    <mat-expansion-panel expanded="true" class="flex-none max-h-1/2 flex flex-col mb-2 mt-0">
        <mat-expansion-panel-header class="flex-none" [collapsedHeight]="'32px'" [expandedHeight]="'32px'">
            <mat-panel-title>
                Dados Informativos
            </mat-panel-title>
            <mat-panel-description>
                Nome, Descrição, Tabela, Dataset
                <mat-icon svgIcon="mat_solid:info"></mat-icon>
            </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-tab-group class="h-full overflow-y-auto">
            <mat-tab [labelClass]="['text-sm', 'font-bold']" label="Definições Básicas">
                <div class="grid sm:grid-cols-12 gap-2">
                    <div class="sm:col-span-2">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Código</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-list-ol"
                                matPrefix></mat-icon>
                            <input
                                readonly
                                class="text-sm"
                                [formControlName]="'code'"
                                matInput>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-3">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Tipo</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-t"
                                matPrefix></mat-icon>
                            <input
                                readonly
                                class="text-sm"
                                [formControlName]="'objectType'"
                                matInput>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-7">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Tabela</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-t"
                                matPrefix></mat-icon>
                            <mat-select class="text-sm" [compareWith]="compareCode" (openedChange)="filterTables.value =null"
                                        (selectionChange)="changeTable($event)" [required]="true" [value]="model.table">
                                <div class="flex flex-col h-full w-full">
                                    <div class="flex-none">
                                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                                            <mat-icon
                                                class="icon-size-4"
                                                fontSet="fas" fontIcon="fa-search"
                                                matPrefix></mat-icon>
                                            <input [autocomplete]="'off'" #filterTables matInput>
                                        </mat-form-field>
                                    </div>
                                    <div class="flex-1 overflow-auto">
                                        <ng-container *ngFor="let t of tables | filterJson : {name: filterTables.value, description: filterTables.value}">
                                            <mat-option [value]="t" >
                                                {{t.name + ' - ' + t.description}}
                                            </mat-option>
                                        </ng-container>
                                    </div>
                                </div>

                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-6">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Nome</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-signature"
                                matPrefix></mat-icon>
                            <input
                                class="text-sm"
                                [formControlName]="'name'" (ngModelChange)="changeName($event)"
                                required
                                matInput>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-6">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Dataset Pai</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-t"
                                matPrefix></mat-icon>
                            <mat-select class="text-sm" [compareWith]="compareCode" (selectionChange)="parentChanged($event)" [value]="model.parent">
                                <mat-option [value]="null" >
                                    Nenhum
                                </mat-option>
                                <ng-container *ngFor="let t of model.relatives">
                                    <mat-option *ngIf="!isMyDescendant(t)" [value]="t" >
                                        {{t.name}}
                                    </mat-option>
                                </ng-container>

                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-6">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Filtro</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-filter"
                                matPrefix></mat-icon>
                            <input
                                class="text-sm"
                                [formControlName]="'filter'"
                                matInput>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-6" [formGroupName]="'customFilter'">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Filtro Customizado</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-filter"
                                matPrefix></mat-icon>
                            <input
                                name="customFilter"
                                class="text-sm"
                                [formControlName]="'value'"
                                matInput>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-6">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Descrição</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-comments"
                                matPrefix></mat-icon>
                            <input
                                class="text-sm"
                                [required]="true"
                                [formControlName]="'description'"
                                matInput>
                        </mat-form-field>
                    </div>
                    <div class="sm:col-span-6" [formGroupName]="'customDescription'">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Descrição Customizada</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-quote-left"
                                matPrefix></mat-icon>
                            <input
                                name="customTableDescription"
                                class="text-sm"
                                [formControlName]="'value'"
                                matInput>
                        </mat-form-field>
                    </div>
                </div>

            </mat-tab>

            <mat-tab [labelClass]="['text-sm', 'font-bold']" label="Configuração Visual">
                <div class="grid sm:grid-cols-12 gap-2">
                    <div class="sm:col-span-12">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-label class="text-sm">Configuração Visual</mat-label>
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-eye"
                                matPrefix></mat-icon>
                            <textarea style="resize: none"
                                      class="text-sm"
                                      [formControlName]="'uiConfiguration'"
                                      matInput
                                      [rows]="3"></textarea>

                        </mat-form-field>
                    </div>
                </div>

            </mat-tab>

            <mat-tab [labelClass]="['text-sm', 'font-bold', hasParentProblem() ? 'invalid-tab' : '']" label="Informações">
                <ng-template mat-tab-label>
                    <label *ngIf="hasParentProblem()">
                        <span><mat-icon class="icon-size-3 text-red-500 mr-1" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>Informações
                        </span>
                    </label>
                    <label *ngIf="!hasParentProblem()">Informações</label>
                </ng-template>

                <div class="w-full" *ngIf="model.parent && model.parent.code >= 0">
                    <div class="grid grid-cols-3 gap-2" *ngIf="hasParentProblem() === false">
                        <ng-container *ngFor="let fk of parentRelation?.fieldsReference">
                            <div class="col-span-1 font-bold text-right">
                                {{'(' + fk.fieldFK.code + ') ' + fk.fieldFK.name}}
                            </div>
                            <div class="col-span-1 font-bold text-center">
                                <mat-icon
                                    class="icon-size-5"
                                    fontSet="fas" fontIcon="fa-arrow-right"
                                    matPrefix></mat-icon>
                            </div>
                            <div class="col-span-1 font-bold text-left">
                                {{'(' + fk.fieldPK.code + ') ' + fk.fieldPK.name}}
                            </div>
                        </ng-container>
                    </div>
                    <div class="font-bold text-red-500 uppercase" *ngIf="hasParentProblem() === true">
                        {{'Atenção!!! Os DATASETS ' + model.table.name + ' e ' + model.parent.name + ' não possuem referências entre si'}}
                    </div>
                </div>

            </mat-tab>
        </mat-tab-group>
    </mat-expansion-panel>
    <mat-expansion-panel expanded="true" class="flex flex-col m-0">
        <mat-expansion-panel-header class="flex-none" [collapsedHeight]="'32px'" [expandedHeight]="'32px'">
            <mat-panel-title>
                Dados Estruturais
            </mat-panel-title>
            <mat-panel-description>
                Campos, Pesquisas, Lookups
                <mat-icon svgIcon="mat_solid:construction"></mat-icon>
            </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-tab-group class="h-full overflow-hidden" (selectedTabChange)="changeTab($event)">
            <mat-tab [labelClass]="['text-sm', 'font-bold', hasValidationProblem('fields') ? 'invalid-tab' : '']" aria-label="fields" label="Campos" bodyClass="table-tab">
                <ng-template mat-tab-label>
                    <label *ngIf="hasValidationProblem('fields')" [matTooltip]="model.invalidFields['fields'] | json">
                        <span><mat-icon class="icon-size-3 text-red-500 mr-1" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>Campos
                        </span>
                    </label>
                    <label *ngIf="!hasValidationProblem('fields')">Campos</label>
                </ng-template>
                <div class="flex-none flex justify-between items-center pt-1">
                    <div class="flex-none flex">
                    </div>
                    <div class="flex-none flex md:w-1/3 md:pr-1">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-search"
                                matPrefix></mat-icon>
                            <input
                                [autocomplete]="'off'"
                                class="text-sm"
                                (input)="filterFields($event)"
                                matInput>
                        </mat-form-field>
                    </div>
                </div>

                <div class="flex-1 overflow-y-auto" cdkScrollable>
                    <ng-container
                        *ngTemplateOutlet="fieldTableTemplate; context: { displayedColumns: displayedFieldColumns, datasource: fieldsDataSource, fieldtype: 'fields' }">
                    </ng-container>

                </div>

            </mat-tab>
            <mat-tab [labelClass]="['text-sm', 'font-bold', hasValidationProblem('searchs') ? 'invalid-tab' : '']" aria-label="searchs" label="Pesquisas" bodyClass="table-tab">
                <ng-template mat-tab-label>
                    <label *ngIf="hasValidationProblem('searchs')" [matTooltip]="model.invalidFields['searchs'] | json">
                        <span><mat-icon class="icon-size-3 text-red-500 mr-1" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>Pesquisas
                        </span>
                    </label>
                    <label *ngIf="!hasValidationProblem('searchs')">Pesquisas</label>
                </ng-template>
                <div class="flex-none flex justify-between items-center pt-1">
                    <div class="flex-none flex">
                        <button class="text-sm min-h-7 h-7"
                                mat-flat-button
                                [disabled]="!model.table || !model.table.code"
                                color="primary" (click)="importSearchTable()">
                            <mat-icon
                                class="icon-size-4"
                                svgIcon="mat_solid:import_export"></mat-icon>
                            <span class="ml-2">Importar Pesquisa da Tabela</span>
                        </button>
                    </div>
                    <div class="flex-none flex md:w-1/3 md:pr-1">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-search"
                                matPrefix></mat-icon>
                            <input
                                [autocomplete]="'off'"
                                class="text-sm"
                                (input)="filterSearchs($event)"
                                matInput>
                        </mat-form-field>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto" cdkScrollable>
                    <table mat-table matSort #sortSearchs="matSort" [dataSource]="searchsDataSource" class="table-auto" (matSortChange)="announceSortChange($event)">
                        <ng-container matColumnDef="buttons">
                            <th mat-header-cell *matHeaderCellDef sticky>
                                <div class="flex flex-row items-center">
                                    <button mat-icon-button aria-label="Add" [disabled]="!model.table || !model.table.code" (click)="newSearch()" matTooltip="Adicionar Pesquisa">
                                        <mat-icon class="icon-size-4 text-blue-500" fontSet="fas" fontIcon="fa-plus"></mat-icon>
                                    </button>
                                </div>
                            </th>
                            <td mat-cell *matCellDef="let model; let i = index">
                                <div class="flex flex-row items-center">
                                    <button mat-icon-button aria-label="Delete" (click)="deleteSearch(model)" matTooltip="Remover Pesquisa">
                                        <mat-icon class="icon-size-4 text-red-500" fontSet="fas" fontIcon="fa-trash"></mat-icon>
                                    </button>
                                    <button mat-icon-button aria-label="Edit" (click)="editSearch(model)" matTooltip="Editar Pesquisa">
                                        <mat-icon class="icon-size-4 text-blue-500" fontSet="fas" fontIcon="fa-edit"></mat-icon>
                                    </button>
                                    <mat-icon *ngIf="!model.pending && model.invalidFields | isValidObject" [matTooltip]="model.invalidFields | json"
                                              class="icon-size-4 text-red-500" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>
                                </div>
                            </td>
                        </ng-container>
                        <!-- code -->
                        <ng-container matColumnDef="code">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                            <td mat-cell *matCellDef="let model"> {{ model.code }} </td>
                        </ng-container>
                        <!-- name -->
                        <ng-container matColumnDef="name">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                            <td mat-cell [evoluiMatCell]="model" *matCellDef="let model"> {{ model.name }} </td>
                        </ng-container>
                        <ng-container matColumnDef="customName">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome Customizado </th>
                            <td mat-cell *matCellDef="let model"> {{ model.customName?.value }} </td>
                        </ng-container>
                        <!-- order -->
                        <ng-container matColumnDef="order">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Order </th>
                            <td mat-cell [evoluiMatCell]="model" *matCellDef="let model"> {{ model.order }} </td>
                        </ng-container>
                        <!-- status -->
                        <ng-container matColumnDef="status">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
                            <td mat-cell [evoluiMatCell]="model" *matCellDef="let model"> {{ model.status }} </td>
                        </ng-container>
                        <!-- type -->
                        <ng-container matColumnDef="type">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                            <td mat-cell [evoluiMatCell]="model" *matCellDef="let model"> {{ model.type }} </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedSearchColumns; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedSearchColumns;"></tr>
                    </table>
                </div>

            </mat-tab>
            <mat-tab [labelClass]="['text-sm', 'font-bold', hasValidationProblem('groupInfos') ? 'invalid-tab' : '']" aria-label="groupInfos" label="Grupos de Informações" bodyClass="table-tab">
                <ng-template mat-tab-label>
                    <label *ngIf="hasValidationProblem('groupInfos')" [matTooltip]="model.invalidFields['groupInfos'] | json">
                        <span><mat-icon class="icon-size-3 text-red-500 mr-1" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>Grupos de Informações
                        </span>
                    </label>
                    <label *ngIf="!hasValidationProblem('groupInfos')">Grupos de Informações</label>
                </ng-template>
                <div class="flex-none flex justify-between items-center pt-1">
                    <div class="flex-none flex">
                    </div>
                    <div class="flex-none flex md:w-1/3 md:pr-1">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-search"
                                matPrefix></mat-icon>
                            <input
                                [autocomplete]="'off'"
                                class="text-sm"
                                (input)="filterGroupsInfo($event)"
                                matInput>
                        </mat-form-field>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto" cdkScrollable>
                    <ng-container
                        *ngTemplateOutlet="fieldTableTemplate; context: { displayedColumns: displayedGroupInfoColumns, datasource: groupsInfoDataSource, fieldtype: 'groupInfos'}">
                    </ng-container>
                </div>
            </mat-tab>
            <mat-tab [labelClass]="['text-sm', 'font-bold', hasValidationProblem('customFields') ? 'invalid-tab' : '']" aria-label="customFields" bodyClass="table-tab">
                <ng-template mat-tab-label>
                    <label *ngIf="hasValidationProblem('customFields')" [matTooltip]="model.invalidFields['customFields'] | json">
                        <span><mat-icon class="icon-size-3 text-red-500 mr-1" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>Campos Adicionais
                        </span>
                    </label>
                    <label *ngIf="!hasValidationProblem('customFields')">Campos Adicionais</label>
                </ng-template>
                <div class="flex-none flex justify-between items-center pt-1">
                    <div class="flex-none flex">
                    </div>
                    <div class="flex-none flex md:w-1/3 md:pr-1">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-search"
                                matPrefix></mat-icon>
                            <input
                                [autocomplete]="'off'"
                                class="text-sm"
                                (input)="filterCustomFields($event)"
                                matInput>
                        </mat-form-field>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto" cdkScrollable>
                    <ng-container
                        *ngTemplateOutlet="fieldTableTemplate; context: { displayedColumns: displayedCustomFieldColumns, datasource: customFieldsDataSource, fieldtype: 'customFields'}">
                    </ng-container>

                </div>
            </mat-tab>
            <mat-tab [labelClass]="['text-sm', 'font-bold', hasValidationProblem('customizations') ? 'invalid-tab' : '']" aria-label="customizations" label="Customizações" bodyClass="table-tab">
                <ng-template mat-tab-label>
                    <label *ngIf="hasValidationProblem('customizations')" [matTooltip]="model.invalidFields['customizations'] | json">
                        <span><mat-icon class="icon-size-3 text-red-500 mr-1" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>Customizações
                        </span>
                    </label>
                    <label *ngIf="!hasValidationProblem('customizations')">Customizações</label>
                </ng-template>
                <div class="flex-none flex justify-between items-center pt-1">
                    <div class="flex-none flex">
                    </div>
                    <div class="flex-none flex md:w-1/3 md:pr-1">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense no-label w-full">
                            <mat-icon
                                class="evolui-menu-item-icon"
                                fontSet="fas" fontIcon="fa-search"
                                matPrefix></mat-icon>
                            <input
                                [autocomplete]="'off'"
                                class="text-sm"
                                (input)="filterCustomizations($event)"
                                matInput>
                        </mat-form-field>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto" cdkScrollable>
                    <ng-container
                        *ngTemplateOutlet="fieldTableTemplate; context: { displayedColumns: displayedCustomizationsColumns, datasource: customizationsDataSource, fieldtype: 'customizations'}">
                    </ng-container>

                </div>
            </mat-tab>
        </mat-tab-group>
    </mat-expansion-panel>
</mat-accordion>
<ng-template #fieldTableTemplate let-displayedColumns="displayedColumns" let-datasource="datasource" let-fieldtype="fieldtype">
    <table mat-table #sortFields="matSort" matSort [dataSource]="datasource" class="table-auto" (matSortChange)="announceSortChange($event)">
        <ng-container matColumnDef="buttons" sticky>
            <th mat-header-cell *matHeaderCellDef>
                <div class="flex flex-row items-center">
                    <button mat-icon-button aria-label="Add" [disabled]="!model.table || !model.table.code" (click)="add(fieldtype)" *ngIf="fieldtype !== 'customizations'">
                        <mat-icon class="icon-size-4 text-blue-500" fontSet="fas" fontIcon="fa-plus"></mat-icon>
                    </button>
                </div>
            </th>
            <td mat-cell *matCellDef="let field; let i = index">
                <div class="flex flex-row items-center">
                    <button mat-icon-button aria-label="Delete" *ngIf="fieldtype !== 'customizations'" (click)="delete(field, fieldtype)" matTooltip="Remover">
                        <mat-icon class="icon-size-4 text-red-500" fontSet="fas" fontIcon="fa-trash"></mat-icon>
                    </button>
                    <button *ngIf="!field['editing']" mat-icon-button aria-label="Edit" (click)="editRow(field, fieldtype)" matTooltip="Editar">
                        <mat-icon class="icon-size-4 text-blue-500" fontSet="fas" fontIcon="fa-edit"></mat-icon>
                    </button>
                    <button *ngIf="field['editing']" mat-icon-button aria-label="Save" (click)="saveRow(field, fieldtype)" matTooltip="Salvar">
                        <mat-icon class="icon-size-4 text-green-500" fontSet="fas" fontIcon="fa-save"></mat-icon>
                    </button>
                    <mat-icon *ngIf="!field.pending && field.invalidFields | isValidObject" [matTooltip]="field.invalidFields | json"
                              class="icon-size-4 text-red-500" fontSet="fas" fontIcon="fa-circle-exclamation"></mat-icon>
                </div>
            </td>
        </ng-container>
        <!-- code -->
        <ng-container matColumnDef="code">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
            <td mat-cell *matCellDef="let field let i = index">
                <div>
                    {{ field.code }}
                </div>
            </td>
        </ng-container>
        <!-- fields !-->
        <ng-container *ngIf="fieldtype === 'fields'">
            <!-- order -->
            <ng-container matColumnDef="order">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.order }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'orderField'+i" class="text-sm" matInput
                                   formControlName="order">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="fieldType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo de Campo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.fieldType }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.key">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PK </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.key }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.name }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="label">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Rótulo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.label }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'labelField'+i" class="text-sm" matInput
                                   formControlName="label">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="customLabel">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Rótulo Customizado </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customLabel?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customLabel')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customLabelField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="mask">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Máscara </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.mask }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'maskField'+i" class="text-sm" matInput
                                   formControlName="mask">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="groupInfo.description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Grupo de Info. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.groupInfo?.description }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">

                            <mat-select class="text-sm" [compareWith]="compareCode"
                                        [formGroup]="getFieldGroup(field, fieldtype).get('groupInfo')">
                                <ng-container *ngFor="let t of model.groupInfos">
                                    <mat-option [value]="{code: t.code, description: t.description, id: t.id}">
                                        {{t.description}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.fieldType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.fieldType }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.size">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.size }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="readOnly">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Somente Leitura </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.readOnly }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)" #group="ngForm">
                        <mat-checkbox [name]="'readOnlyField'+i" class="text-sm" formControlName="readOnly"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="visible">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Visível </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.visible }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)" #group="ngForm">
                        <mat-checkbox [name]="'visibleField'+i" class="text-sm" formControlName="visible"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="notNull">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Obrigatório </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.notNull }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)" #group="ngForm">
                        <mat-checkbox [name]="'notNullField'+i" class="text-sm" formControlName="notNull"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="search">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Busca </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.search }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-checkbox [name]="'searchField'+i" class="text-sm" formControlName="search"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.defaultValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Default </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.defaultValue }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.precision">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Precisão </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.precision }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.maxValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Max. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.maxValue }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.minValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Min. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.minValue }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="charCase">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> CharCase </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.charCase }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'charCaseField'+i" class="text-sm"
                                        formControlName="charCase">

                                <mat-option *ngFor="let t of LuthierFieldCharcaseEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="editor">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Editor </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.editor }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'editorField'+i" class="text-sm"
                                        formControlName="editor">

                                <mat-option *ngFor="let t of LuthierFieldEditorEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="lookupFilter">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Lookup Filter </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.lookupFilter }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'lookupFilter'+i" class="text-sm" matInput
                                   formControlName="lookupFilter">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="reference.name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Referência </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.reference?.name }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="technicalDescription">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Detalhes Técnicos </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.technicalDescription }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'technicalDescriptionField'+i" class="text-sm" matInput
                                   formControlName="technicalDescription">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="userDescription">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Help </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.userDescription }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'userDescriptionField'+i" class="text-sm" matInput
                                   formControlName="userDescription">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="uiConfiguration">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Config. Visual </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.uiConfiguration }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'uiConfigurationField'+i" class="text-sm" matInput
                                   formControlName="uiConfiguration">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="layoutSize">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho Layout </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.layoutSize }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'layoutSizeField'+i" class="text-sm"
                                        formControlName="layoutSize">

                                <mat-option *ngFor="let t of LuthierFieldLayoutEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <!-- customFields !-->
        <ng-container *ngIf="fieldtype === 'customFields'">
            <ng-container matColumnDef="order">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.order }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'orderField'+i" class="text-sm" matInput
                                   formControlName="order">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="fieldType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo de Campo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.fieldType }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.key">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PK </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.key }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.name }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="label">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Rótulo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.label }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'labelField'+i" class="text-sm" matInput
                                   formControlName="label">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="mask">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Máscara </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.mask }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'maskField'+i" class="text-sm" matInput
                                   formControlName="mask">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="groupInfo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Grupo de Info. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.groupInfo }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">

                            <mat-select class="text-sm"
                                        [formControl]="getFieldGroup(field, fieldtype).get('groupInfo')">
                                <ng-container *ngFor="let t of model.groupInfos">
                                    <mat-option [value]="t.description">
                                        {{t.description}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.fieldType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.fieldType }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.size">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.size }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="readOnly">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Somente Leitura </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.readOnly }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)" #group="ngForm">
                        <mat-checkbox [name]="'readOnlyField'+i" class="text-sm" formControlName="readOnly"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="visible">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Visível </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.visible }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)" #group="ngForm">
                        <mat-checkbox [name]="'visibleField'+i" class="text-sm" formControlName="visible"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="notNull">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Obrigatório </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.notNull }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)" #group="ngForm">
                        <mat-checkbox [name]="'notNullField'+i" class="text-sm" formControlName="notNull"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="search">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Busca </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.search }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-checkbox [name]="'searchField'+i" class="text-sm" formControlName="search"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.defaultValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Default </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.defaultValue }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.precision">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Precisão </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.precision }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.maxValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Max. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.maxValue }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="tableField.minValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Min. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.minValue }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="charCase">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> CharCase </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.charCase }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'charCaseField'+i" class="text-sm"
                                        formControlName="charCase">

                                <mat-option *ngFor="let t of LuthierFieldCharcaseEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="editor">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Editor </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.editor }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'editorField'+i" class="text-sm"
                                        formControlName="editor">

                                <mat-option *ngFor="let t of LuthierFieldEditorEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="lookupFilter">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Lookup Filter </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.lookupFilter }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'lookupFilter'+i" class="text-sm" matInput
                                   formControlName="lookupFilter">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="reference">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Referência </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.reference }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="technicalDescription">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Detalhes Técnicos </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.technicalDescription }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'technicalDescriptionField'+i" class="text-sm" matInput
                                   formControlName="technicalDescription">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="userDescription">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Help </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.userDescription }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'userDescriptionField'+i" class="text-sm" matInput
                                   formControlName="userDescription">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="uiConfiguration">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Config. Visual </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.uiConfiguration }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'uiConfigurationField'+i" class="text-sm" matInput
                                   formControlName="uiConfiguration">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="layoutSize">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho Layout </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.layoutSize }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'layoutSizeField'+i" class="text-sm"
                                        formControlName="layoutSize">

                                <mat-option *ngFor="let t of LuthierFieldLayoutEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <!-- groupInfos !-->
        <ng-container *ngIf="fieldtype === 'groupInfos'">
            <!-- order -->
            <ng-container matColumnDef="order">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.order }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'orderField'+i" class="text-sm" matInput
                                   formControlName="order">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- description -->
            <ng-container matColumnDef="description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Descrição </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.description }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'description'+i" class="text-sm" matInput
                                   formControlName="description">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- groupInfoType -->
            <ng-container matColumnDef="groupInfoType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell [evoluiMatCell]="field" *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.groupInfoType }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'groupInfoTypeField'+i" class="text-sm"
                                        formControlName="groupInfoType">

                                <mat-option *ngFor="let t of LuthierGroupInfoTypeEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- parent.description -->
            <ng-container matColumnDef="parent.description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Grupo Pai </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.parent?.description }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">

                            <mat-select class="text-sm" [compareWith]="compareCode"
                                        [formControl]="getFieldGroup(field, fieldtype).get('parent')">
                                <ng-container *ngFor="let t of model.groupInfos">
                                    <mat-option *ngIf="isGroupInfoAllowed(field, t)" [value]="{code: t.code, description: t.description, id: t.id}">
                                        {{t.description}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <!-- customizations !-->
        <ng-container *ngIf="fieldtype==='customizations'">
            <ng-container matColumnDef="tableField.name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.tableField?.name }}
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="customMask">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Máscara </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customMask?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customMask')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customMaskField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="customReadOnly">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Somente Leitura </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customReadOnly?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customReadOnly')" #group="ngForm">
                        <mat-checkbox [name]="'customReadOnlyField'+i" class="text-sm" formControlName="value"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="customVisible">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Visível </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customVisible?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customVisible')" #group="ngForm">
                        <mat-checkbox [name]="'customVisibleField'+i" class="text-sm" formControlName="value"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="customNotNull">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Obrigatório </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customNotNull?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customNotNull')" #group="ngForm">
                        <mat-checkbox [name]="'customNotNullField'+i" class="text-sm" formControlName="value"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <ng-container matColumnDef="customCharCase">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> CharCase </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customCharCase?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customCharCase')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'customCharCaseField'+i" class="text-sm"
                                        formControlName="value">
                                <mat-option [value]="null" >
                                    {{'NULL'}}

                                </mat-option>
                                <mat-option *ngFor="let t of LuthierFieldCharcaseEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="customEditor">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Editor </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customEditor?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customEditor')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'customEditorField'+i" class="text-sm"
                                        formControlName="value">
                                <mat-option [value]="null" >
                                    {{'NULL'}}

                                </mat-option>
                                <mat-option *ngFor="let t of LuthierFieldEditorEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="customLookupFilter">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Lookup Filter </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customLookupFilter?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customLookupFilter')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customLookupFilterField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <ng-container matColumnDef="customUiConfiguration">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Config. Visual </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="!field['editing']">
                        {{ field.customUiConfiguration?.value }}
                    </div>
                    <div *ngIf="field['editing']" class="flex flex-row items-center" [formGroup]="getFieldGroup(field, fieldtype).get('customUiConfiguration')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customUiConfigurationField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onRowClick(row.elementIndex)"></tr>
    </table>
</ng-template>
