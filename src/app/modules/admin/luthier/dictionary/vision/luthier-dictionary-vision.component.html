<div class="h-full flex flex-col headers-align" [formGroup]="formSave">
    <div class="flex-none flex mb-2">
        <button class="text-sm min-h-7 h-7"
                mat-flat-button
                color="primary" (click)="save()">
            <mat-icon
                class="icon-size-4"
                svgIcon="mat_solid:save"></mat-icon>
            <span class="ml-2">Salvar</span>
        </button>
        <button class="text-sm min-h-7 h-7"
                mat-flat-button
                color="accent" (click)="revert()">
            <mat-icon
                class="icon-size-4"
                svgIcon="mat_solid:undo"></mat-icon>
            <span class="ml-2">Reverter</span>
        </button>
    </div>
    <div class="grid sm:grid-cols-12 gap-2 flex-none mb-2 mt-0">
        <div class="sm:col-span-3">
            <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                <mat-label class="text-sm">Código</mat-label>
                <mat-icon
                    class="evolui-menu-item-icon"
                    fontSet="fas" fontIcon="fa-list-ol"
                    matPrefix></mat-icon>
                <input
                    readonly
                    class="text-sm"
                    [formControlName]="'code'"
                    matInput>
            </mat-form-field>
        </div>
        <div class="sm:col-span-9"></div>
        <div class="sm:col-span-3">
            <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                <mat-label class="text-sm">Tipo</mat-label>
                <mat-icon
                    class="evolui-menu-item-icon"
                    fontSet="fas" fontIcon="fa-t"
                    matPrefix></mat-icon>
                <input
                    readonly
                    class="text-sm"
                    [value]="model.objectType"
                    matInput>
            </mat-form-field>
        </div>
        <div class="sm:col-span-9"></div>
        <div class="sm:col-span-6">
            <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                <mat-label class="text-sm">Nome</mat-label>
                <mat-icon
                    class="evolui-menu-item-icon"
                    fontSet="fas" fontIcon="fa-signature"
                    matPrefix></mat-icon>
                <input
                    class="text-sm"
                    [formControlName]="'name'"
                    required
                    matInput>
            </mat-form-field>
        </div>
        <div class="sm:col-span-6"></div>
        <div class="sm:col-span-6">
            <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                <mat-label class="text-sm">Descrição</mat-label>
                <mat-icon
                    class="evolui-menu-item-icon"
                    fontSet="fas" fontIcon="fa-comments"
                    matPrefix></mat-icon>
                <input
                    class="text-sm"
                    [required]="true"
                    [formControlName]="'description'"
                    matInput>
            </mat-form-field>
        </div>
        <div class="sm:col-span-6"></div>
    </div>
</div>
<ng-template #fieldTableTemplate let-displayedColumns="displayedColumns" let-datasource="datasource" let-fieldtype="fieldtype">
    <table #tableFields mat-table #sortFields="matSort" matSort [dataSource]="datasource" class="table-auto" (matSortChange)="announceSortChange($event)">
        <ng-container matColumnDef="buttons" sticky>
            <th mat-header-cell *matHeaderCellDef>
                <div class="flex flex-row items-center">
                    <button mat-icon-button aria-label="Add" (click)="add(fieldtype)" *ngIf="fieldtype !== 'customizations'">
                        <mat-icon class="icon-size-4 text-blue-500" fontSet="fas" fontIcon="fa-plus"></mat-icon>
                    </button>
                </div>
            </th>
            <td mat-cell *matCellDef="let field; let i = index">
                <div class="flex flex-row items-center">
                    <button mat-icon-button aria-label="Delete" *ngIf="fieldtype !== 'customizations'" (click)="delete(field.id, i, fieldtype)" matTooltip="Remover">
                        <mat-icon class="icon-size-4 text-red-500" fontSet="fas" fontIcon="fa-trash"></mat-icon>
                    </button>
                    <button *ngIf="!fieldRowEditing[fieldtype]" mat-icon-button aria-label="Edit" (click)="editRow(i, fieldtype)" matTooltip="Editar">
                        <mat-icon class="icon-size-4 text-blue-500" fontSet="fas" fontIcon="fa-edit"></mat-icon>
                    </button>
                    <button *ngIf="fieldRowEditing[fieldtype] === i.toString()" mat-icon-button aria-label="Save" (click)="saveRow(field.id, i, fieldtype)" matTooltip="Salvar">
                        <mat-icon class="icon-size-4 text-green-500" fontSet="fas" fontIcon="fa-save"></mat-icon>
                    </button>
                    <button *ngIf="!fieldRowEditing[fieldtype] && (fieldtype === 'fields' || fieldtype === 'customFields')" mat-icon-button aria-label="Detail" (click)="detailField(field, i, fieldtype)" matTooltip="Detalhes do Campo">
                        <mat-icon class="icon-size-4 text-accent" fontSet="fas" fontIcon="fa-glasses"></mat-icon>
                    </button>
                </div>
            </td>
        </ng-container>
        <!-- code -->
        <ng-container matColumnDef="code">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
            <td mat-cell *matCellDef="let field let i = index">
                <div>
                    {{ field.code }}
                </div>
            </td>
        </ng-container>
        <ng-container *ngIf="fieldtype === 'fields' || fieldtype === 'customFields' || fieldtype === 'groupInfos'">
            <!-- order -->
            <ng-container matColumnDef="order">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.order }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'orderField'+i" class="text-sm" matInput
                                   formControlName="order">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="fieldtype === 'fields' || fieldtype === 'customFields'">
            <!-- key -->
            <ng-container matColumnDef="key">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> PK </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.key }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-checkbox [name]="'keyField'+i" class="text-sm" formControlName="key"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <!-- name -->
            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.name }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'nameField'+i" class="text-sm" matInput
                                   formControlName="name">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- label -->
            <ng-container matColumnDef="label">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Rótulo </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.label }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'labelField'+i" class="text-sm" matInput
                                   formControlName="label">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- fieldType -->
            <ng-container matColumnDef="fieldType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.fieldType }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'fieldTypeField'+i" class="text-sm"
                                        formControlName="fieldType">

                                <mat-option *ngFor="let t of LuthierFieldTypeEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- modifyType -->
            <ng-container matColumnDef="modifyType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Modificador </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.modifyType }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'modifyTypeField'+i" class="text-sm"
                                        formControlName="modifyType">

                                <mat-option *ngFor="let t of LuthierFieldModifierEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- attributeName -->
            <ng-container matColumnDef="attributeName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome Atributo </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.attributeName }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'attributeNameField'+i" class="text-sm" matInput
                                   formControlName="attributeName">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- autoInc -->
            <ng-container matColumnDef="autoInc">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> AutoInc </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.autoInc }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-checkbox [name]="'autoIncField'+i" class="text-sm" formControlName="autoInc"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <!-- size -->
            <ng-container matColumnDef="size">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.size }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'sizeField'+i" class="text-sm" matInput
                                   formControlName="size">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- search -->
            <ng-container matColumnDef="search">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Busca </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.search }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-checkbox [name]="'searchField'+i" class="text-sm" formControlName="search"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <!-- notNull -->
            <ng-container matColumnDef="notNull">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Obrigatório </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.notNull }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)" #group="ngForm">
                        <mat-checkbox (change)="checkIndeterminate($event, group.form.get('notNull'))"
                                      [indeterminate]="group.form.get('notNull').value === null"
                                      [name]="'notNullField'+i" class="text-sm" formControlName="notNull"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <!-- defaultValue -->
            <ng-container matColumnDef="defaultValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Default </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.defaultValue }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'defaultValueField'+i" class="text-sm" matInput
                                   formControlName="defaultValue">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- precision -->
            <ng-container matColumnDef="precision">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Precisão </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.precision }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'precisionField'+i" class="text-sm" matInput
                                   formControlName="precision">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- maxValue -->
            <ng-container matColumnDef="maxValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Max. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.maxValue }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'maxValueField'+i" class="text-sm" matInput
                                   formControlName="maxValue">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- minValue -->
            <ng-container matColumnDef="minValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Min. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.minValue }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'minValueField'+i" class="text-sm" matInput
                                   formControlName="minValue">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- mask -->
            <ng-container matColumnDef="mask">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Máscara </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.mask }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'maskField'+i" class="text-sm" matInput
                                   formControlName="mask">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- charCase -->
            <ng-container matColumnDef="charCase">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> CharCase </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.charCase }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'charCaseField'+i" class="text-sm"
                                        formControlName="charCase">

                                <mat-option *ngFor="let t of LuthierFieldCharcaseEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- editor -->
            <ng-container matColumnDef="editor">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Editor </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.editor }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'editorField'+i" class="text-sm"
                                        formControlName="editor">

                                <mat-option *ngFor="let t of LuthierFieldEditorEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- uiConfiguration -->
            <ng-container matColumnDef="uiConfiguration">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Config. Visual </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.uiConfiguration }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'uiConfigurationField'+i" class="text-sm" matInput
                                   formControlName="uiConfiguration">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- layoutSize -->
            <ng-container matColumnDef="layoutSize">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho Layout </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.layoutSize }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'layoutSizeField'+i" class="text-sm"
                                        formControlName="layoutSize">

                                <mat-option *ngFor="let t of LuthierFieldLayoutEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="fieldtype === 'fields'">
            <!-- customLabel -->
            <ng-container matColumnDef="customLabel">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Rótulo Customizado </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customLabel?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customLabel')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customLabelField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- groupInfoCode -->
            <ng-container matColumnDef="groupInfo.description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Grupo de Info. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.groupInfo?.description }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">

                            <mat-select class="text-sm" [compareWith]="compareCode"
                                        [formControl]="getFieldGroup(field.id, fieldtype).get('groupInfo')">
                                <ng-container *ngFor="let t of model.groupInfos">
                                    <mat-option [value]="{code: t.code, description: t.description, id: t.id}">
                                        {{t.description}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="fieldtype === 'customFields'">
            <ng-container matColumnDef="groupInfo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Grupo de Info. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.groupInfo }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">

                            <mat-select class="text-sm"
                                        [formControl]="getFieldGroup(field.id, fieldtype).get('groupInfo')">
                                <ng-container *ngFor="let t of model.groupInfos">
                                    <mat-option [value]="t.description">
                                        {{t.description}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="fieldtype==='customizations'">
            <!-- name -->
            <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div>
                        {{ field.name }}
                    </div>
                </td>
            </ng-container>
            <!-- customSize -->
            <ng-container matColumnDef="customSize">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tamanho </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customSize?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing?.row === i" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customSize')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'customSizeField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customNotNull -->
            <ng-container matColumnDef="customNotNull">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Obrigatório </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customNotNull?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customNotNull')" #group="ngForm">
                        <mat-checkbox (change)="checkIndeterminate($event, group.form.get('value'))"
                                      [indeterminate]="group.form.get('value').value === null"
                                      [name]="'customNotNullField'+i" class="text-sm" formControlName="value"></mat-checkbox>
                    </div>

                </td>
            </ng-container>
            <!-- customDefaultValue -->
            <ng-container matColumnDef="customDefaultValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Default </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customDefaultValue?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customDefaultValue')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customDefaultValueField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customPrecision -->
            <ng-container matColumnDef="customPrecision">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Precisão </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customPrecision?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customPrecision')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input mask="0*" [name]="'customPrecisionField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customMaxValue -->
            <ng-container matColumnDef="customMaxValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Max. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customMaxValue?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customMaxValue')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customMaxValueField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customMinValue -->
            <ng-container matColumnDef="customMinValue">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Valor Min. </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customMinValue?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customMinValue')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customMinValueField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customMask -->
            <ng-container matColumnDef="customMask">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Máscara </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customMask?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customMask')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customMaskField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customCharCase -->
            <ng-container matColumnDef="customCharCase">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> CharCase </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customCharCase?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customCharCase')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'customCharCaseField'+i" class="text-sm"
                                        formControlName="value">
                                <mat-option [value]="null" >
                                    {{'NULL'}}

                                </mat-option>
                                <mat-option *ngFor="let t of LuthierFieldCharcaseEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customEditor -->
            <ng-container matColumnDef="customEditor">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo Editor </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customEditor?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customEditor')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'customEditorField'+i" class="text-sm"
                                        formControlName="value">
                                <mat-option [value]="null" >
                                    {{'NULL'}}

                                </mat-option>
                                <mat-option *ngFor="let t of LuthierFieldEditorEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- customUiConfiguration -->
            <ng-container matColumnDef="customUiConfiguration">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Config. Visual </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.customUiConfiguration?.value }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype).get('customUiConfiguration')">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'customUiConfigurationField'+i" class="text-sm" matInput
                                   formControlName="value">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <ng-container *ngIf="fieldtype==='groupInfos'">
            <!-- description -->
            <ng-container matColumnDef="description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Descrição </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.description }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <input [name]="'description'+i" class="text-sm" matInput
                                   formControlName="description">
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- groupInfoType -->
            <ng-container matColumnDef="groupInfoType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.groupInfoType }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center" [formGroup]="getFieldGroup(field.id, fieldtype)">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">
                            <mat-select [name]="'groupInfoTypeField'+i" class="text-sm"
                                        formControlName="groupInfoType">

                                <mat-option *ngFor="let t of LuthierGroupInfoTypeEnum | enumArray" [value]="t.key" >
                                    {{t.key}}

                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
            <!-- parent.description -->
            <ng-container matColumnDef="parent.description">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Grupo Pai </th>
                <td mat-cell *matCellDef="let field let i = index">
                    <div *ngIf="fieldRowEditing[fieldtype] !== i.toString()">
                        {{ field.parent?.description }}
                    </div>
                    <div *ngIf="fieldRowEditing[fieldtype] === i.toString()" class="flex flex-row items-center">
                        <mat-form-field [subscriptSizing]="'dynamic'" class="fuse-mat-xdense w-full">

                            <mat-select class="text-sm" [compareWith]="compareCode"
                                        [formControl]="getFieldGroup(field.id, fieldtype).get('parent')">
                                <ng-container *ngFor="let t of model.groupInfos">
                                    <mat-option *ngIf="isGroupInfoAllowed(field, t)" [value]="{code: t.code, description: t.description, id: t.id}">
                                        {{t.description}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </td>
            </ng-container>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="onRowClick(row.elementIndex)"></tr>
    </table>
</ng-template>
